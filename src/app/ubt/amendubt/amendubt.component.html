
<mat-toolbar>
        <span>Amend Unique Business Transaction</span>
      </mat-toolbar>
      <div
    class="padding"
    fxLayout="row wrap"
    fxLayoutAlign="space-evenly end"
>

    <mat-form-field fxFlex="20">
        <mat-select
            placeholder="Customer"
            [(ngModel)]="value"
            (ngModelChange)="onchange($event)"
        >
            <mat-option
                *ngFor="let item of customer"
                value="{{item.CustomerId}}"
            >
                {{item.CustomerName}}
            </mat-option>
        </mat-select>
    </mat-form-field>
    <div fxFlex="20">
        <span>From Date</span>
        <input
            class="form-control"
            placeholder="DateOfJoin"
            bsDatepicker
            #dp="bsDatepicker"
            [(ngModel)]="FromDate"
            (ngModelChange)="fromDateChange()"
            [bsConfig]="{ dateInputFormat: 'YYYY-MM-DD' }"
        >
    </div>

    <div fxFlex="20">
        <span>To Date</span>
        <input
            class="form-control"
            placeholder="DateOfJoin"
            bsDatepicker
            #dp="bsDatepicker"
            [(ngModel)]="ToDate"
            (ngModelChange)="toDateChange()"
            [bsConfig]="{ dateInputFormat: 'YYYY-MM-DD' }"
        >
    </div>
    <!-- <div fxFlex="20"> -->
            
    <mat-form-field fxFlex="10">
            <mat-select
                placeholder="Status"
                [(ngModel)]="StatusName"
            >
                <mat-option
                    *ngFor="let item of status"
                    value="{{item.StatusName}}"
                >
                    {{item.StatusName}}
                </mat-option>
            </mat-select>
          </mat-form-field>
    <!-- </div> -->
    <button
        mat-raised-button
        fxFlex="16"
        (click)="search()"
        color="primary"
    >
        Search
    </button>
</div>
<!-- <button type="button" class="btn btn-primary" (click)="openModal(template)">Create template modal</button> -->
 


  <div fxLayout="row" fxLayoutAlign="start start" >
        
           
    <!-- <div fxFlex="15">
          
            <mat-chip-list *ngFor="let item of ids;let i = index;" fxLayout="row wrap" fxLayoutAlign="space-around center">
                    <mat-chip fxFlex="100" color="primary" selected  (click)="edit(item)">{{i +1}}.  {{ item.UbtId }}</mat-chip>
                    <mat-divider></mat-divider>
                  </mat-chip-list>
                  
    
    </div> -->
    <div
        fxFlex="20"
        class="card"
        *ngIf="ids.length != 0"
    >
    <mat-chip-list *ngFor="let item of ids;let i = index;" fxLayout="row wrap" fxLayoutAlign="space-around center">
        <mat-chip fxFlex="100"  selected  (click)="edit(item)">{{i +1}}.  {{ item.UbtId }}</mat-chip>
        <mat-divider></mat-divider>
      </mat-chip-list>
</div>
  
    <div
        fxFlex="85"
        class="container"
        *ngIf="editDetails" 
    >
    <div
    fxLayout="row wrap"
    fxLayoutAlign="center center"
>
    <mat-form-field fxFlex="30" class="padding-left">
        <mat-select
            placeholder="Customer Name"
            [(ngModel)]="customerIdSelected"
        >
            <mat-option
                *ngFor="let item of customer"
                value="{{item.CustomerName}}"
            >
                {{item.CustomerName}}
            </mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field fxFlex="30" class="padding-left">
        <mat-select
            placeholder="Agency Name"
            [(ngModel)]="agencyIdSelected"
        >
            <mat-option
                *ngFor="let item of agency"
                [value]="item.AgencyName"
            >
                {{item.AgencyName}}
            </mat-option>
        </mat-select>
    </mat-form-field>
</div>
<div class="panel-body" >
        <table class="table table-striped table-bordered table-list">
            <thead>
                <tr style="color:#6f6f6f;background-color:#f0f0f0">
                    <th>S.No</th>
                    <th>GoodsType </th>
                    <!-- <th>Category Id</th> -->
                    <th>Category Name</th>
                    <th>Quantity</th>
                    <th>Base Price</th>
                    <th>Max Marigin</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td></td>
                    <td>
                        <mat-form-field>
                            <mat-select
                                placeholder="Goods Type"
                                [(ngModel)]="goodsTypeSelected"
                                (ngModelChange)="onchangeGoodsType($event)"
                            >
                                <mat-option
                                    *ngFor="let item of goodsType"
                                    [value]="item.GoodsTypeName"
                                >
                                    {{item.GoodsTypeName}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </td>
                    <td>
                        <mat-form-field>
                            <mat-select
                                placeholder="Category"
                                [(ngModel)]="categoryIdSelected"
                                (ngModelChange)="onchangeCategoryName($event)"
                            >
                                <mat-option
                                    *ngFor="let item of CategoryNameList"
                                    [value]="item.CategoryId"
                                >
                                    {{item.CategoryName}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </td>
                    <td>
                        <mat-form-field>
                            <input
                                matInput
                                [(ngModel)]="Quantity"
                            >
                        </mat-form-field>
                    </td>
                    <td>
                        <mat-form-field>
                            <input
                                matInput
                                [(ngModel)]="BasePrice"
                            >
                        </mat-form-field>
                    </td>
                    <td>
                        <mat-form-field>
                            <input
                                matInput
                                [(ngModel)]="MaxMargin"
                            >
                        </mat-form-field>
                    </td>
    
                    <td>
                        <button
                            class="btn btn"
                            style="cursor: pointer;background-color: #3e54af;color:#fff"
                            (click)="add()"
                        >
                            <i class="fa fa-plus"></i>
                        </button>
                    </td>
                </tr>
                <tr
                *ngFor="let items of addedNewUbts; let i = index"
                [attr.data-index]="i"
                 >
                <td>{{i + 1}}</td>
                <td>{{items.GoodsType}}</td>
              
                <td>{{items.CategoryName}}</td>
                <td>{{items.Quantity}}</td>
                <td>{{items.BasePrice}}</td>
                <td>{{items.MaxMargin}}</td>
                <td>
                    <button
                        class="btn btn"
                        style="cursor: pointer;background-color: #D50000 !important;color:#fff"
                        (click)="delete(items)"
                    >
                        <i
                            class="fa fa-trash"
                            aria-hidden="true"
                        ></i>
                    </button>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
    <div align="right" >
            <button mat-raised-button (click)="saveRecords()" *ngIf='addedNewUbts.length !=0' color="primary">Save</button>
    </div>
    <table class="table table-striped table-bordered table-list">
        <thead>
            <tr style="color:#6f6f6f;background-color:#f0f0f0">
                <th>S.No</th>
                <th>GoodsType </th>
                <th>Category Name</th>
                <th>Quantity</th>
                <th>Base Price</th>
                <th>Max Marigin</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <tr
                *ngFor="let items of udtData; let i = index"
                [attr.data-index]="i"
                 >
                <td>{{i + 1}}</td>
                <td>{{items.GoodsType}}</td>
                <td>{{items.CategoryName}}</td>
                <td>{{items.Quantity}}</td>
                <td>{{items.BasePrice}}</td>
                <td>{{items.MaxMargin}}</td>
                <td>
                        <button
                         class="btn btn padding-left"
                         style="cursor: pointer;color:#fff"
                       (click)="openModal(items,template)"
                     >
                     <i class="fa fa-pencil" aria-hidden="true"></i>
                     </button>
                    <button
                        class="btn btn"
                        style="cursor: pointer;background-color: #D50000 !important;color:#fff;margin-left:8px"
                        (click)="delete(items)"
                    >
                        <i
                            class="fa fa-trash"
                            aria-hidden="true"
                        ></i>
                    </button>
                 
                </td>
    
            </tr>
        </tbody>
    </table>
    </div>
    
    </div>

    <ng-template #template style="width:1308px;">
        <div class="modal-header " style="background-color:#fff;width: 900px;">
          <h4 class="modal-title pull-left">Edit Ubt Details</h4>
        </div>
        <div class="modal-body" style="background-color:#fff;width: 900px;">
            <div class="card">
                <div
                fxLayout="row"
                fxLayoutAlign="space-between center" 
               
            >
                <div class="padding-left">
                    <span style="font-weight:400">CategoryId : </span>
                    <span style="background-color: bisque">{{individualUbtCategory.CategoryId}}</span>
                </div>

                <div class="padding-left">
                    <span style="font-weight:400">UBT Id : </span>
                    <span style="background-color: bisque">{{individualUbtCategory.UbtId}}</span>
                </div>
                <div class="padding-left">
                    <span style="font-weight:400">GoodsType : </span>
                    <span style="background-color: bisque">{{individualUbtCategory.GoodsType}}</span>
                </div>
            </div>
            </div>
       
          <div class="example-container">
                
            <mat-form-field fxFlex="30" class="padding-left">
              <input matInput placeholder="Quantity"  [(ngModel)]="individualUbtCategory.Quantity" >
            </mat-form-field>
               
            <mat-form-field fxFlex="30" class="padding-left">
              <input matInput placeholder="Base Price" [(ngModel)]="individualUbtCategory.BasePrice">
             </mat-form-field>
             <mat-form-field fxFlex="30" class="padding-left">
               <input matInput placeholder="Max Marigin" [(ngModel)]="individualUbtCategory.MaxMargin">
              </mat-form-field>
          
             
          </div>
          <div align="right">
          <button mat-button style="color:#fff !important" (click)="updateRecord()">Update</button>
        </div>
        </div> 
      </ng-template>
    